@page "/history"
@inject IAccountService AccountService;
@inject IStorageService StorageService;
@using BlazorStandaloneApp.Domain


<PageTitle>History</PageTitle>

<h1>History</h1>

    <table class="accounts-table">
        <thead>
            <tr>
                <th>Action</th>
                <th>Amount</th>
                <th>From</th>
                <th>To</th>
                <th>Account Balance</th>
                <th>Last updated</th>
            </tr>
        </thead>
        <tbody> 
        @foreach (var account in _accounts)
        {
            <tr>
                <td>@account.TransactionType</td>
                <td>@account.Amount Currency</td>
                <td>@account.FromAccountId || Withdraw</td>
                <td>@account.ToAccountId || Deposit</td>
                <td>@account.Balance</td>
                <td>@account.LastUpdated.ToLocalTime()</td>
            </tr>
        }
        </tbody>
    </table>


@code
{
    private List<BankAccount> _accounts = new();
    private List<Transaction> _transactions = new();
     protected override async Task OnInitializedAsync()
    {
        _accounts = await AccountService.GetAccounts();
        _transactions = await StorageService.GetItemAsync<List<Transaction>>("transactions") ?? new List<Transaction>();
    }
}